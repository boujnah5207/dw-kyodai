<?xml version="1.0" encoding="UTF-8" ?> 
<Module>
 <ModulePrefs author="Hyram Duke" author_email="hyramduke@gmail.com" description="My first gadget" thumbnail="http://www.labpixies.com/campaigns/flood/images/thumb120x60.png" screenshot="http://www.labpixies.com/campaigns/flood/images/screenshot_orkut.png" title_url="" title="DW Kyodai" height="220">
  <Require feature="rpc"/>
  <Require feature="dynamic-height"/> 
  <Require feature="setprefs"/>
  <Require feature="views"/>
  <Require feature="analytics" />
 </ModulePrefs>
	<UserPref name="scores" default_value="0" datatype="hidden"/>
  <UserPref name="rank" default_value="0" datatype="hidden"/>

  <Content type="html" view="canvas">
  <![CDATA[ 
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script type="text/javascript" src="http://dw-kyodai.googlecode.com/svn/trunk/js/kyodai.js"></script>
    <link href="http://dw-kyodai.googlecode.com/svn/trunk/css/style.css" rel="stylesheet" type="text/css">
    <script type="text/javascript">
		var prefs = new _IG_Prefs();
		var scores = prefs.getInt("scores");
		var rank = prefs.getInt("rank");
		
		function init(){ 
      kyodai.preload();
			
			
	    $("#kyodai_start").click(function() {
		    kyodai.start();
	    });
	    $("#kyodai_ppt_1_num").click(function() {
		    kyodai.use(1);
	    });
	    $("#kyodai_ppt_2_num").click(function() {
		    kyodai.use(2);
	    });
    }
		
		_IG_RegisterOnloadHandler(init);
    </script>

    <div id="everything">
      <div id="middle">
				<div id="kyodai_scene">
					<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=7,0,19,0" name="flashrek" style="display:none" id="au_sound">
						<param name="movie" value="http://dw-kyodai.googlecode.com/svn/trunk/sound/SE.swf" />
						<param name="quality" value="high" />
						<embed src="http://dw-kyodai.googlecode.com/svn/trunk/sound/SE.swf" width="285" height="200" quality="high" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash"></embed>
					</object>
				
					<img id="kyodai_game" style="position:absolute"/>
					<div id="kyodai_map">
						<div id="kyodai_lines" style="position:absolute"></div>
						<div id="kyodai_items" style="position:absolute"></div>
						<div id="kyodai_preload" style="position:absolute"></div>
						<img id="kyodai_choose" style="position:absolute;left:-999px;"/>
						<img id="kyodai_hover" style="position:absolute;left:-999px;"/>
						<div id="kyodai_cuechoose" style="position:absolute;z-index:999"></div>
					</div>
					
					<div id="kyodai_remain"></div>
					<div id="kyodai_combo"></div>
					<div id="kyodai_board">
						<span id="kyodai_scores"></span>
						<span id="kyodai_update"></span>
					</div>
					<div id="kyodai_count"><img /></div>
					<div id="kyodai_center"></div>
					<div id="kyodai_start">Start Game</div>
					<div id="toolbox">
						<div id="kyodai_ppt"><img /></div>
						<div id="kyodai_ppt_num"></div>
					</div>
				</div>
			</div>
		</div>
  ]]> 
  </Content>
  
    <Content type="html" view="home">
  <![CDATA[ 
    <title>DW Kyodai</title>
    <style type="text/css">
      body {
        text-align:center;
        font-family:arial;
      }
      
      #main {
        width:246px;
        height:156px;
        cursor:pointer;
        margin-top:20px;
      }
      
      #rank{position:relative;left:95px;top: 23px;text-align:left;font-size:12px;font-weight:bold;}
      #levelspan, #scorespan{color:#374D4F;}
      #mylevel{color:#3DA500;}
      #myscore{color:#d70674;}
      #mainplay{position:relative; top: 72px; color: #FFFFFF; font-size:14px; font-weight: bold;text-align: center;}
    </style>
    
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>

    <script type="text/javascript">
			var area = 'public';
      var IMAGES_BASE = 'http://dw-kyodai.googlecode.com/svn/trunk/images/';
      var prefs = new _IG_Prefs();
      var scores = prefs.getInt("scores");
      var rank = prefs.getInt("rank");

      //get's the images from the cache from the 'images' directory
      function getCachedImage(src) {
        //return IMAGES_BASE+src;
				if (area == 'public')
					return _IG_GetImageUrl(IMAGES_BASE+src);
				else
					return ('images/' + src)
      }
            
      function switchToCanvas( params ) {
      	map = gadgets.views.getSupportedViews();
      	gadgets.views.requestNavigateTo( map['canvas'], params );
      }
      
      function init(){ 
        $('#main').css('background','url'+'('+getCachedImage('main.png')+') no-repeat');
        $('#mylevel').html('Rank ' + rank);
        $('#myscore').html(scores);
      }
			
			_IG_RegisterOnloadHandler(init);
    </script>
    
 
    <div id="container" align="center">
      <div id="main" onclick="switchToCanvas();">
        <div id="rank">
          <span id="levelspan">Level: </span> <span id="mylevel">Rank 1</span><br/><br/>
          <span id="scorespan">Score: </span> <span id="myscore">100</span><br/>
          
        </div>
        <div id="mainplay">Play Now!</div>
      </div>
    </div>
  ]]> 
  </Content>
</Module>
